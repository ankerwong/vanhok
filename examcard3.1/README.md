# 萬鶴書院 HKDSE準考證生成系統 v2.0

## 🎯 系統簡介

基於HKDSE官方準考證格式，為萬鶴書院定制的準考證批量生成系統。支持**一名考生應考多個科目**，自動生成包含所有科目信息的準考證。

## ✨ 核心功能

### 1. 多科目支持（重要更新）
- **一張準考證包含該考生的所有科目**
- 自動按考生編號合併多科目記錄
- 科目表格自動擴展，支持任意數量科目
- Excel模板支持多行輸入（同一考生多行，每行一個科目）

### 2. 雙重輸入方式
- **Excel批量導入**（推薦）
  - 支持拖拽上傳
  - 提供多科目示例模板
  - 自動合併同一考生的多科目記錄
- **手動輸入**
  - 填寫考生基本信息後可連續添加多個科目
  - 保留考生信息便於添加更多科目

### 3. 官方格式還原
- 基於2025年HKDSE官方準考證格式
- 中英對照排版
- 完整的備註說明

### 4. 萬鶴書院定制
- ✅ Logo替換為萬鶴書院標識
- ✅ 刪除照片欄位
- ✅ 刪除地址欄位
- ✅ 入境許可證號統一填充：XX12345678
- ✅ 保留官方備註內容

### 5. 批量處理
- 考生編號條形碼（CODE128格式）
- 日期格式自動轉換（YYYY-MM-DD → DD-MMM）
- 一鍵生成所有準考證
- 批量下載為單一PDF文件
- 實時顯示生成進度

## 📋 Excel模板字段說明

### 多科目輸入格式（推薦）

**方式：同一考生多行，每行一個科目**

| 姓名 | 英文姓名 | 考生編號 | 性別 | 科目 | 應考語言 | 考場 | 考試日期 | 考試時間 |
|------|---------|---------|------|------|---------|------|----------|----------|
| 張偉明 | ZHANG Weiming | A123456 | M | English Language 英國語文 | 英文 English | Room 101 | 2025-04-15 | 09:00 - 11:30 |
| 張偉明 | ZHANG Weiming | A123456 | M | Chinese Language 中國語文 | 中文 Chinese | Room 102 | 2025-04-16 | 14:00 - 16:30 |
| 張偉明 | ZHANG Weiming | A123456 | M | Mathematics 數學 | 英文 English | Room 103 | 2025-04-17 | 09:00 - 11:30 |

**說明：**
- 同一考生的多條記錄使用**相同的考生編號**
- 系統會自動按考生編號合併
- 每行對應該考生的一個科目
- 基本信息（姓名、性別）可以在每行重複填寫（系統會取第一次出現的值）

### 必填字段
- 考生編號 (Candidate Number) *
- 姓名 (Name) *
- 性別 (Gender) * - 填寫 M 或 F
- 科目 (Subject) *

### 選填字段
- 英文姓名 (Name in English)
- 應考語言 (Exam Language)
- 考場 (Venue)
- 考試日期 (Exam Date) - 格式：YYYY-MM-DD
- 考試時間 (Exam Time) - 格式：HH:MM - HH:MM

## 🚀 快速開始

### 1. 下載並打開系統
```
解壓 admission-card-system-v2.0.zip
雙擊打開 index.html
```

### 2. 使用Excel批量導入（推薦）

**步驟：**
1. 點擊「📥 下載Excel模板」
2. 在Excel中填寫考生資料：
   - 每個考生可以有多行
   - 每行填寫一個科目
   - 相同考生使用相同的考生編號
3. 上傳填寫好的Excel文件
4. 系統自動合併同一考生的多科目
5. 點擊「生成準考證」
6. 點擊「📥 批量下載PDF」

**示例：**
```
張偉明考3科 → Excel中填3行（相同考生編號A123456）
李小華考2科 → Excel中填2行（相同考生編號A123457）
```

### 3. 手動輸入

**步驟：**
1. 切換到「手動輸入」標籤
2. 填寫考生基本信息（姓名、編號、性別）
3. 填寫第一個科目信息
4. 點擊「添加考生」
5. **繼續添加更多科目**：
   - 考生信息保持不變
   - 只需填寫新的科目信息
   - 再次點擊「添加考生」
6. 完成後點擊「生成準考證」

## 📄 準考證內容

### 基本信息
- 考生姓名（中文）
- 英文姓名
- 考生編號
- 性別
- 身份證明文件：入境許可證 XX12345678

### 科目信息表格（支持多行）
每個科目一行，包含：
- 科目名稱
- 應考語言
- 試場
- 試場編號（固定為 "-"）
- 考試日期
- 考試時間

### 其他元素
- 萬鶴書院Logo
- 考生編號條形碼（右上角）
- 完整的考試備註說明（5條，中英對照）

## 🎨 準考證特點

### 多科目排版
- 科目表格自動擴展高度
- 每個科目佔一行
- 表格可容納任意數量科目
- 保持A4紙張大小

### 格式細節
- 尺寸：A4 (210mm × 297mm)
- 字體：中文使用微軟雅黑，英文使用Arial
- 邊距：四周12mm
- 表格：黑色邊框，標題灰色背景
- 條形碼：CODE128格式，60px高度

## 💡 使用技巧

### Excel導入技巧
1. **保持考生編號一致**：同一考生的所有記錄必須使用完全相同的考生編號
2. **複製粘貼基本信息**：可以複製第一行的基本信息到後續行
3. **日期格式**：使用 YYYY-MM-DD 格式（如 2025-04-15）
4. **科目命名**：建議使用中英對照（如 "English Language 英國語文"）

### 手動輸入技巧
1. **添加多科目**：填寫完第一個科目後，基本信息保留，繼續填寫下一個科目
2. **快速輸入**：只需更改科目相關字段，考生信息不用重複輸入
3. **即時查看**：每添加一個科目，列表會顯示該考生的科目數量

### 生成與下載
1. **預覽檢查**：生成後先預覽，確認所有科目都正確顯示
2. **批量下載**：所有準考證會合併為一個PDF文件
3. **進度顯示**：下載時會顯示生成進度（如 "生成中... 3/10"）

## 🔧 技術規格

- **前端技術**：純HTML + CSS + JavaScript
- **依賴庫**：
  - JsBarcode 3.11.5（條形碼生成）
  - SheetJS (XLSX) 0.18.5（Excel處理）
  - jsPDF 2.5.1（PDF生成）
  - html2canvas 1.4.1（HTML轉圖片）
- **瀏覽器支持**：Chrome, Firefox, Safari, Edge（最新版本）
- **運行環境**：完全離線，無需服務器
- **數據處理**：前端本地處理，不上傳任何數據

## 📦 文件結構

```
admission-card-system-v2.0/
├── index.html                 # 主頁面
├── admission-card-style.css   # 主樣式
├── card-style.css             # 準考證樣式
├── admission-card-script.js   # 核心邏輯（含多科目支持）
├── README.md                  # 本說明文檔
└── PROJECT_SUMMARY.md         # 項目總結
```

## 🆕 v2.0 更新日誌

### 重大功能更新
✅ **多科目支持**
- 一張準考證可包含多個科目
- Excel支持同一考生多行輸入
- 自動按考生編號合併記錄
- 科目表格自動擴展

✅ **數據處理優化**
- 使用Map結構按考生編號分組
- 智能合併同一考生的多條記錄
- 考生列表顯示總科目數

✅ **排版改進**
- 科目表格支持動態行數
- 保持A4紙張大小不變
- 優化表格行距與字體大小

✅ **Excel模板更新**
- 提供多科目示例
- 同一考生3科的完整案例
- 多個考生的對比示例

## 🎯 適用場景

1. **學校考試**：批量生成校內模擬考試準考證
2. **HKDSE備考**：萬鶴書院內部HKDSE模擬考試
3. **多科目考試**：一名考生同時應考多個科目
4. **快速生成**：臨時需要打印大量準考證

## 📞 技術支持

如遇問題，請檢查：
1. 是否使用最新版本瀏覽器
2. Excel格式是否符合模板要求
3. 考生編號是否一致（多科目情況）
4. 瀏覽器控制台是否有錯誤信息

## 📄 版本信息

- **版本號**：v2.0
- **發布日期**：2026-02-06
- **主要更新**：支持一名考生多科目
- **開發單位**：萬鶴書院 Vanhok Academy

---

© 2026 萬鶴書院 Vanhok Academy. All rights reserved.
