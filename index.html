<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ä¸‡é¹¤ä¹¦é™¢ä¿¡æ¯å‘å¸ƒé¡µ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            background: #f7f9fa;
            font-family: 'Noto Sans SC', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background: #3e70c9;
            color: white;
            padding: 32px 0 20px 0;
            text-align: center;
            letter-spacing: 4px;
            box-shadow: 0 4px 10px rgba(62,112,201,0.08);
        }
        h1 {
            margin: 0;
            font-size: 2.2em;
            letter-spacing: 4px;
        }
        main {
            max-width: 600px;
            margin: 32px auto 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 16px rgba(62,112,201,0.10);
            padding: 36px 28px 28px 28px;
        }
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        li {
            margin: 15px 0;
            font-size: 1.1em;
        }
        a {
            text-decoration: none;
            color: #2156ae;
            transition: color 0.2s;
        }
        a:hover {
            color: #13408b;
            text-decoration: underline;
        }
        .folder {
            font-weight: bold;
            color: #333;
            font-size: 1.08em;
        }
        .emoji-folder {
            margin-right: 4px;
        }
        .note {
            color: #888;
            font-size: 0.97em;
            text-align: right;
            margin-top: -8px;
            margin-bottom: 22px;
        }
    </style>
</head>
<body>
    <header>
        <h1>ä¸‡é¹¤ä¹¦é™¢ä¿¡æ¯å‘å¸ƒé¡µ</h1>
        <div class="note">ä»…æ˜¾ç¤ºæ¯ç»„é¡µé¢æœ€æ–°ç‰ˆæœ¬</div>
    </header>
    <main>
        <ul id="directory-list"></ul>
    </main>
    <script>
        // é…ç½®
        const username = "ankerwong"; // ä¿®æ”¹ä¸ºä½ çš„GitHubç”¨æˆ·å
        const repo = "vanhokE"; // ä¿®æ”¹ä¸ºä½ çš„ä»“åº“å
        const branch = "main"; // å¦‚æœä¸»åˆ†æ”¯ä¸æ˜¯mainè¯·ä¿®æ”¹

        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/?ref=${branch}`;
        const baseUrl = `https://${username}.github.io/${repo}/`;

        // è·å–ç‰ˆæœ¬å·å‡½æ•°ï¼Œå¦‚fuduban2025.htmlçš„2025
        function extractVersion(filename) {
            const match = filename.match(/(\d{4,})\.html$/i);
            return match ? parseInt(match[1]) : null;
        }
        // è·å–ä¸»æ–‡ä»¶åï¼Œä¸å«å¹´ä»½
        function baseName(filename) {
            return filename.replace(/\d{4,}\.html$/i, '').replace(/\.html$/i, '');
        }

        fetch(apiUrl)
            .then(response => response.json())
            .then(items => {
                // åªä¿ç•™æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
                const files = items.filter(item => item.type === 'file' && item.name.endsWith('.html'));
                const dirs = items.filter(item => item.type === 'dir');

                // æ–‡ä»¶å»é‡ï¼Œåªæ˜¾ç¤ºæ¯ç»„æœ€æ–°ç‰ˆæœ¬
                const latestFiles = {};
                files.forEach(file => {
                    const name = baseName(file.name);
                    const version = extractVersion(file.name) || 0;
                    if (!latestFiles[name] || version > latestFiles[name].version) {
                        latestFiles[name] = {
                            name: file.name,
                            url: baseUrl + file.name,
                            version: version
                        };
                    }
                });

                // æ¸²æŸ“æ–‡ä»¶
                const ul = document.getElementById('directory-list');
                // æ–‡ä»¶å¤¹ä¼˜å…ˆ
                dirs.forEach(dir => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.textContent = "ğŸ“ " + dir.name + "/";
                    a.href = baseUrl + dir.name + "/";
                    a.className = "folder";
                    li.appendChild(a);
                    ul.appendChild(li);
                });
                // æ–‡ä»¶
                Object.values(latestFiles).sort((a, b) => a.name.localeCompare(b.name)).forEach(file => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.textContent = file.name;
                    a.href = file.url;
                    a.target = "_blank";
                    li.appendChild(a);
                    ul.appendChild(li);
                });
            })
            .catch(error => {
                document.getElementById('directory-list').innerHTML = "<li>è·å–ç›®å½•å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•ã€‚</li>";
                console.error(error);
            });
    </script>
</body>
</html>
